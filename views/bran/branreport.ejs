<!DOCTYPE html>
<html lang="en">

<head>
       <meta charset="UTF-8">
       <meta http-equiv="X-UA-Compatible" content="IE=edge">
       <meta name="viewport" content="width=device-width, initial-scale=1.0">




       <!-- -------------------------------------------app manisfest------------------------------------------ -->
       <link rel="manifest" href="/manifest/branReport_manifest.json">


       <!-- ------------------------------- bootstrap--------------------------------------------------- -->
       <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet">

       <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
              integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
              crossorigin="anonymous">
       </script>
       <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"
              integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13"
              crossorigin="anonymous">
       </script>
       <!-- --------------------------------------------fonts ----------------------------------------------------- -->

       <link rel="preconnect" href="https://fonts.googleapis.com">
       <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
       <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;1,800&display=swap"
              rel="stylesheet">
       <!-- google fonts link  -->
       <link href='https://fonts.googleapis.com/css?family=Permanent Marker' rel='stylesheet'>
       <link rel="preconnect" href="https://fonts.googleapis.com">
       <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
       <link href="https://fonts.googleapis.com/css2?family=Smooch&display=swap" rel="stylesheet">

       <!-- ---------------------------------------------vue-------------------------------------------------------- -->
       <script defer src="https://unpkg.com/vue@next"></script>

       <!-- ---------------------------------------------------custom styles----------------------------------- -->
       <link rel="stylesheet" href="/style.css">
       <script defer src="/scripts.js"></script>


       <title>Bran report</title>
</head>

<body>
       <!-- passing the data from the ejs to input to vue app  -->


       <div id="app" class="d-none">

              <nav-bar>
                     <input id="ejsdata" type="text" class="d-none" value="<%= logs?JSON.stringify(logs):[] %>">
                     <%= title?title:"Deafult Title" %>
                     <div class="badge font-monospace fw-lighter" style="font-size: 12px;font-weight: 200;">
                            (<%= user?user:"no user" %>)
                     </div>
              </nav-bar>


              <v-crud>

                     <!-- CRUD app header -->
                     <div class="container my-3">
                            <h1 class="d-inline">CRUD</h1>
                            <div class="btn btn-outline-primary float-end " @click="showForm = !showForm"
                                   v-if="!showForm && !editForm">
                                   <span>+ Add new</span>
                            </div>
                            <div class="btn btn-outline-primary float-end " @click="showForm=false;editForm=false"
                                   v-else>
                                   <span v-show="true">cancel</span>
                            </div>
                     </div>

                     <hr>

                     <!-- edit and delete form -->
                     <div class="editDeleteByIdForm" v-show="editForm" :editbyid="editbyid">
                            <form :action="'/branreport/obj_id/'+editbyid" method="post" autocomplete="off"
                                   class="m-0 p-0 container card">

                                   <div class="bg-light p-4" id="details">
                                          <p class="">
                                                 <h4>Edit form</h4>
                                                 refno :<br><input name="refno" type="number"
                                                        :value="data.filter(d=>d._id===editbyid).map(d=>d.refno)[0]">
                                                 <br>
                                                 party* :<br><input name="party"
                                                        :value="data.filter(d=>d._id===editbyid).map(d=>d.party)[0]"
                                                        required> <br>
                                                 broker* :<br><input name="broker"
                                                        :value="data.filter(d=>d._id===editbyid).map(d=>d.broker)[0]"
                                                        required> <br>
                                                 <!-- logTime :<input name="logTime" id=""> <br> -->
                                                 sampleDate* :<br><input type="date" name="sampleDate"
                                                        :value="dateForInputFormat(data.filter(d=>d._id===editbyid).map(d=>d.sampleDate)[0])"
                                                        required><br>
                                                 bags* :<br><input name="bags"
                                                        :value="data.filter(d=>d._id===editbyid).map(d=>d.bags)[0]"
                                                        inputmode="numeric"> <br>
                                                 branReport :<br><input name="branReport"
                                                        :value="data.filter(d=>d._id===editbyid).map(d=>d.branReport)[0]"
                                                        inputmode="numeric"><br>
                                                 plantBranReport :<br><input name="plantBranReport"
                                                        :value="data.filter(d=>d._id===editbyid).map(d=>d.plantBranReport)[0]"
                                                        inputmode="numeric"> <br>
                                                 naration :<br><input name="naration"
                                                        :value="data.filter(d=>d._id===editbyid).map(d=>d.naration)[0]">
                                                 <br>
                                                 user :<br><input name="user" class="disabled btn"
                                                        :value="data.filter(d=>d._id===editbyid).map(d=>d.user)[0]">
                                                 <br>
                                                 <input type="submit" value="submit" class="btn btn-primary m-4">
                                          </p>
                                   </div>
                            </form>

                            <form :action="'/branreport/obj_id/del/'+editbyid" method="post" class="h-0">
                                   <input type="submit" value="delete" class="btn btn-dark text-danger shadow delbtn">
                            </form>
                     </div>

                     <!-- input form -->
                     <form action="/branreport" method="post" v-show="showForm" autocomplete="off"
                            class="m-0 p-0 container card">


                            <div class="bg-light p-4 ">
                                   <p>
                                          <h4>Add Form</h4>
                                          refno :<br><input name="refno" type="number"> <br>
                                          party* :<br><input name="party" required> <br>
                                          broker* :<br><input name="broker" required> <br>
                                          <!-- logTime :<input name="logTime" id=""> <br> -->
                                          sampleDate* :<br><input type="date" name="sampleDate" required><br>
                                          bags* :<br><input name="bags" inputmode="numeric" required> <br>
                                          branReport :<br><input name="branReport" inputmode="numeric"><br>
                                          plantBranReport :<br><input name="plantBranReport" inputmode="numeric"> <br>
                                          naration :<br><input name="naration"> <br>
                                          user :<input name="user" value="<%= user %>" class="disabled btn"> <br>
                                          <input type="submit" value="submit" class="btn btn-primary m-4">
                                   </p>
                            </div>
                     </form>

                     <!-- table component -->
                     <small>

                            <table v-show="!showForm && !editForm"
                                   class="table-bordered table table-responsive table-striped small">
                                   <thead class="m-0 p-0 text-center ">
                                          <tr style="position: sticky;top: -1px;"
                                                 class="bg-light shadow-sm border-bottom">
                                                 <th>#</th>
                                                 <th>Date</th>
                                                 <th>#Ref</th>
                                                 <th>P & B</th>
                                                 <th>Bags</th>
                                                 <th>oil</th>
                                                 <th>plant</th>
                                                 <th><small> edit</small> </th>
                                          </tr>
                                   </thead>
                                   <tbody class="text-center">
                                          <tr v-for="d in data">
                                                 <td>{{d.sno}}</td>
                                                 <td>{{shortDateFormat(d.sampleDate)}}</td>
                                                 <td>{{d.refno}}</td>
                                                 <td>{{d.party[0] + " - " +d.broker[0]}}</td>
                                                 <td>{{d.bags}}</td>
                                                 <td><div v-bind:class="{ mean: mean(d.branReport,d.plantBranReport) }"><div v-bind:class="{ mean: mean2(d.branReport,d.plantBranReport) }"></div></div>{{d.branReport}}</td>
                                                 <td>{{d.plantBranReport}}</td>
                                                 <td @click="editbyid = d._id;editForm = true" class="text-center">
                                                        <small><svg xmlns="http://www.w3.org/2000/svg" width="16"
                                                                      height="16" fill="currentColor"
                                                                      class="bi bi-pencil-square" viewBox="0 0 16 16">
                                                                      <path
                                                                             d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z" />
                                                                      <path fill-rule="evenodd"
                                                                             d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z" />
                                                               </svg></small>
                                                 </td>
                                          </tr>
                                   </tbody>

                            </table>
                     </small>

              </v-crud>

       </div>
       <div class="bg-secondary bg-opacity-25" style="height: 120px;">

       </div>

</body>

</html>